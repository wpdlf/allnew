<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>숫자야구</title>
</head>

<body>
    <script>
        //화면구성    
        let title = document.createElement("h1");
        title.textContent = "숫자야구";
        document.body.append(title);

        let form = document.createElement("form");
        document.body.append(form);

        let input = document.createElement("input");
        input.maxLength = 3;
        form.append(input);

        let btn = document.createElement("button");
        btn.textContent = "입력"
        form.append(btn);

        let result = document.createElement("div");
        document.body.append(result);

        //숫자뽑기
        let numbers
        let chosenNum

        function selectNumFn() {
            numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9];
            chosenNum = [];
            for (let i = 0; i < 3; i++) {
                let threeNum = [];
                threeNum = numbers.splice(Math.floor(Math.random() * (9 - i)), 1)[0];
                chosenNum.push(threeNum);
            }
        }
        selectNumFn();
        console.log(chosenNum);

        let tryCnt = 0;
        form.addEventListener('submit', function (e) {
            e.preventDefault();
            let answer = input.value; //string
            if (answer == chosenNum.join('')) { //답이 맞으면

                result.textContent = "홈런! 축하합니다.";
                input.value = "";
                input.focus();
                //다음 문제 내기
                selectNumFn();
                tryCnt = 0;

            } else { //답이 틀리면 ball, strike 안내
                let answerArray = answer.split(''); //string
                let ball = 0;
                let strike = 0;
                tryCnt += 1;

                if (tryCnt > 20) { //10회 이상 실패시
                    result.textContent = '횟수 초과로 실패하였습니다. 답은 ' + chosenNum.join(', ') + '입니다.';
                    input.value = '';
                    input.focus();
                    //다음 문제 내기
                    selectNumFn();
                    tryCnt = 0;
                    console.log('다음문제' + chosenNum);
                } else {
                    for (let i = 0; i < 4; i += 1) {
                        if (Number(answerArray[i]) === chosenNum[i]) { //같은 자리이면 strike
                            strike += 1;
                        } else if (chosenNum.indexOf(Number(answerArray[i])) > -1) {
                            ball += 1;
                        }
                    }
                    result.textContent = `${strike}스트라이크, ${ball}볼입니다.`;
                    input.value = "";
                    input.focus();
                }
            }
        });
    </script>

</body>

</html>